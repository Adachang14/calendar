<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</title>
  <style>
    body { font-family: sans-serif; margin: 20px; background: #f8f8f8; }
    h1 { text-align: center; }
    .calendar-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; max-width: 800px; margin: 0 auto 10px auto; }
    .calendar-nav { display: flex; align-items: center; gap: 10px; }
    .calendar-nav button { padding: 5px 10px; border: none; background: #ccc; border-radius: 5px; cursor: pointer; }
    .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; max-width: 600px; margin: auto; }
    .day, .header { padding: 10px; background: white; text-align: center; border-radius: 8px; cursor: pointer; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    .header { font-weight: bold; background: #e0e0e0; cursor: default; }
    .today { background: #ffecb3 !important; }
    .selected { background: #ffcccc !important; }
    .note-box { margin-top: 10px; }
    .note-input { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; margin-top: 5px; }
    .all-notes { max-width: 600px; margin: 30px auto; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
    .all-notes h3 { margin-top: 0; }
    .note-entry { margin-bottom: 10px; }
    .legend { font-size: 14px; text-align: right; margin-right: 20px; }
    .legend span { display: inline-block; width: 16px; height: 16px; border-radius: 3px; margin-right: 6px; vertical-align: middle; }
    .red { background: #ffcccc; }
    .white { background: #ffffff; border: 1px solid #ccc; }
    .yellow { background: #ffecb3; }
    .warning { color: red; font-size: 14px; font-weight: bold; margin-top: 5px; }
    .select-dropdown select {
      padding: 6px 12px;
      border-radius: 5px;
      border: 1px solid #ccc;
      background: #fff;
      font-size: 14px;
    }
    .legend-container {
      position: absolute;
      top: 10px;
      right: 10px;
      text-align: right;
      font-size: 14px;
    }
  </style>
</head>
<body>
<h1>‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h1>
<div class="calendar-header">
  <div class="calendar-nav">
    <div class="select-dropdown">
      <select id="month-selector" onchange="selectMonth(event)">
        <option value="0">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
        <option value="1">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
        <option value="2">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
        <option value="3">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
        <option value="4">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
        <option value="5">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
        <option value="6">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
        <option value="7">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
        <option value="8">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
        <option value="9">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
        <option value="10">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
        <option value="11">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
      </select>
    </div>
    <div class="select-dropdown">
      <select id="year-selector" onchange="selectYear(event)">
        <option value="2568">2568</option>
        <option value="2569">2569</option>
        <option value="2570">2570</option>
        <option value="2571">2571</option>
        <option value="2572">2572</option>
        <option value="2573">2573</option>
        <option value="2574">2574</option>
      </select>
    </div>
    <button onclick="changeMonth(-1)">‚óÄÔ∏è ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button>
    <span id="current-month"></span>
    <button onclick="changeMonth(1)">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ñ∂Ô∏è</button>
  </div>
</div>
<div id="calendar" class="calendar"></div>
<div class="note-box" style="max-width:600px;margin:auto;display:none;">
  <h3 id="note-date"></h3>
  <textarea id="note-input" class="note-input" rows="4" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ..."></textarea>
</div>
<div class="all-notes" id="all-notes">
  <h3>‡πÇ‡∏ô‡πä‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3>
  <div id="notes-list"></div>
</div>

<div class="legend-container">
  <div><span class="red"></span>‡∏™‡∏µ‡πÅ‡∏î‡∏á = ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡πÄ‡∏Å‡πà‡∏≤</div>
  <div><span class="white"></span>‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß = ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÄ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà</div>
  <div><span class="yellow"></span>‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á = ‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
  <div class="warning">13 ‡πÄ‡∏°‡∏©‡∏≤ ‡∏ñ‡∏∂‡∏á 6 ‡∏û‡∏§‡∏©‡∏†‡∏≤ 68 ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</div>
</div>

<script>
const calendarEl = document.getElementById('calendar');
const noteBox = document.querySelector('.note-box');
const noteDate = document.getElementById('note-date');
const noteInput = document.getElementById('note-input');
const currentMonthLabel = document.getElementById('current-month');
const notesListEl = document.getElementById('notes-list');
let selectedDate = '';

const monthNames = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°','‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå','‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°','‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô','‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°','‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô','‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°','‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°','‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô','‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°','‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô','‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
const days = ['‡∏≠‡∏≤','‡∏à','‡∏≠','‡∏û','‡∏û‡∏§','‡∏®','‡∏™'];

let viewDate = new Date();

function renderCalendar(date) {
  const year = date.getFullYear();
  const month = date.getMonth();
  const today = new Date();

  calendarEl.innerHTML = '';
  currentMonthLabel.innerText = `${monthNames[month]} ${year}`;

  const monthSelector = document.getElementById('month-selector');
  const yearSelector = document.getElementById('year-selector');

  if (monthSelector) monthSelector.value = month;
  if (yearSelector) yearSelector.value = year;

  for (let d of days) {
    let cell = document.createElement('div');
    cell.className = 'header';
    cell.innerText = d;
    calendarEl.appendChild(cell);
  }

  const firstDay = new Date(year, month, 1);
  const lastDate = new Date(year, month + 1, 0).getDate();
  const startDay = firstDay.getDay();

  for (let i = 0; i < startDay; i++) {
    let blank = document.createElement('div');
    calendarEl.appendChild(blank);
  }

  for (let d = 1; d <= lastDate; d++) {
    let cell = document.createElement('div');
    cell.className = 'day';
    if (d === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
      cell.classList.add('today');
    }

    const key = `${year}-${month + 1}-${d}`;
    if (localStorage.getItem(key + '-selected')) {
      cell.classList.add('selected');
    }

    cell.innerText = d;
    cell.onclick = () => {
      cell.classList.toggle('selected');
      if (cell.classList.contains('selected')) {
        localStorage.setItem(key + '-selected', true);
      } else {
        localStorage.removeItem(key + '-selected');
      }
      openNote(year, month, d);
    };
    calendarEl.appendChild(cell);
  }

  renderAllNotes(year, month);
}

function openNote(y, m, d) {
  selectedDate = `${y}-${m + 1}-${d}`;
  noteBox.style.display = 'block';
  noteDate.innerText = `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${d} ${monthNames[m]} ${y}`;
  noteInput.value = localStorage.getItem(selectedDate) || '';
}

noteInput.addEventListener('input', () => {
  if (selectedDate) {
    localStorage.setItem(selectedDate, noteInput.value);
    const parts = selectedDate.split('-');
    renderAllNotes(parseInt(parts[0]), parseInt(parts[1]) - 1);

    // üéØ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets
    fetch('https://script.google.com/macros/s/AKfycbzRMtscDTUEcVGCOje4-eGJ52hjKMzblo8ijsDJ4vsMHhduw0DV7r1o4WuiZE-aHEE1/exec', {
      method: 'POST',
      body: JSON.stringify({
        date: selectedDate,
        note: noteInput.value
      }),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(res => res.text())
    .then(data => console.log('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢:', data))
    .catch(err => console.error('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', err));
  }
});

function changeMonth(offset) {
  viewDate.setMonth(viewDate.getMonth() + offset);
  localStorage.setItem('viewDate', viewDate.toISOString());
  renderCalendar(viewDate);
}

function selectMonth(event) {
  const monthIndex = parseInt(event.target.value);
  viewDate.setMonth(monthIndex);
  localStorage.setItem('viewDate', viewDate.toISOString());
  renderCalendar(viewDate);
}

function selectYear(event) {
  const year = parseInt(event.target.value);
  viewDate.setFullYear(year);
  localStorage.setItem('viewDate', viewDate.toISOString());
  renderCalendar(viewDate);
}

function renderAllNotes(year, month) {
  notesListEl.innerHTML = '';
  const entries = [];
  for (let i = 1; i <= 31; i++) {
    const key = `${year}-${month + 1}-${i}`;
    const note = localStorage.getItem(key);
    if (note && note.trim() !== '') {
      entries.push({ day: i, text: note });
    }
  }
  entries.sort((a, b) => a.day - b.day);
  for (let entry of entries) {
    const div = document.createElement('div');
    div.className = 'note-entry';
    div.innerText = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${entry.day}  ${entry.text}`;
    notesListEl.appendChild(div);
  }
}

const savedViewDate = localStorage.getItem('viewDate');
if (savedViewDate) {
  viewDate = new Date(savedViewDate);
} else {
  viewDate = new Date();
}

renderCalendar(viewDate);
</script>
</body>
</html>
